# Mafia Wars: Criminal Empire
## Comprehensive Game Design Document

*Criminal Empire* is an asynchronous multiplayer web-based simulation game where players build and manage criminal organizations in a shared city environment. Set in a stylized mid-20th century urban landscape, players compete for influence, wealth, and power while navigating the complex web of alliances, betrayals, and law enforcement pressure.

## 1. CORE GAMEPLAY LOOP

### *Primary Player Activity Cycle*
1. **Complete Operations(PvE)** → 2. **Acquire Resources** → 3. **Expand Territory(PvP)** → 4. **Gain Influence/Respect & Reduce Heat** → Repeat

## 2. ESSENTIAL SYSTEMS

### *Resource Economy*
- **Money**: Primary resource used for all activities
- **Crew Members**: Limited resource that enables parallel operations
- **Weapons**: Limited resource that enables parallel operations
- **Vehicles**: Limited resource that enables parallel operations

### *Player Attribute*
- Unlike traditional experience and level system, player attributes in this game can be gained and lost dynamically.
- Attribute types consist of the following:
  - **Respect**: Determined by success/failure rate of your territorial actions
  - **Influence**: Determined by your overall territorial control
  - **Title**: Determined by your overall respect & influence
  - **Heat**: Negative attribute that accumulates through activities

### *Territory Control*
- City map divided into:
  - **Regions**: North, South, East, West, Southeast, Southwest, Northeast, Northwest. Contains multiple districts.
  - **District**: Contains multiple cities
  - **Cities**: Contains multiple hotspots
  - **Hotspots**: Essentially legal/illegal businesses 
- **Illegal businesses**: Cannot be controlled but you can extort and they are not fixed as they might change every day randomized - basically also a PvE thing
- **Legal businesses**: Can be controlled via takeover and can be fortified via defending.
  - Control is binary for simplicity: you either control a location or you don't
  - Controlling a hotspot provides specific benefits:
    - Income generation every hour (but you need to collect them manually)
    - Access to specific operation types
    - Neighborhood influence (controlling multiple locations in same area)

### *Territory Actions*
- Territory actions consist are probabilistic and consist of:
  - **Extortion**: Extort an illegal business for quick profit. Can possibly gain crew and money or lose crew, weapons, vehicle and money. Success depends on resources used (crew, weapons, vehicle) and chance.
  - **Takeover**: Attempt to takeover a legal business. Resources generated are money. Success depends on controlling player's defend resources deployed and chance. Can lose or gain crew, weapons and vehicle upon sucess of takeover but only lose resources upon failure. Resource basically get transferred to the opposing player.
  - **Collection**: Attempt to make collection of accumulated resource generated by a controlled hotspot. Higher the amount, the more chance that collection might fail/ lower collection rate/ higher heat generated. Can lose crew, weapons, vehicle. If a hotspot with accumulated resource generated was not collected and was taken over by a new player, that player will essentially be able to collect the resource generated.
  - **Defend**: Allocated resources such as crew, weapons, vehicle at a particular hotspots do defend against takeover. However, the resources allocated could be lost upon multiple takeover attempts which essentially will increase the probability of it being taken over.

### *Operations System*
- Operations are basically a mission/quest-like PvE events that is refreshed daily.
- Operation types consist as follows:
  - **Basic operation**: Can be completed by all title types.
    - There would be 10 basic operations available and refresh daily.
  - **Special operations**: Only be available if certain player stats are met i.e. influence level/heat level
    - There would be 5 available special operations.
- Similar to territorial actions, these operations would consume certain resources according to the operation types.
- Operation types can affect resources and stats and are outlined as follows:
  - **Carjacking**: ???
  - **Goods Smuggling**: ???
  - **Drug Trafficking**: ???
  - **Official Bribing**: ???
  - **Intelligence gathering**: ???
  - **Crew recruitment**: ???

## 3. PLAYER INTERACTION

### *Indirect Competition*
- Players can see who controls which locations
- Can attempt to take over locations controlled by others
- Success chance reduced based on defender's security level
- Global rankings by wealth, influence, respect and heat

### *Market System*
- Centralized market for selling and buying resources.
- Fixed categories (crew members, weapons and vehicles) with dynamic global pricing based on supply/demand. Simply put, if alot of players are selling a particular resource, price will reduce and in contrast if alot of players are buying that particular resource, the price will increase.
- No direct player-to-player transfers (prevents multiple account abuse)

## 4. PROGRESSION MECHANICS

### *Short-Term Goals*
- Daily operations completion targets
- Location control milestones

### *Medium-Term Objectives*
- Controlling multiple locations in a neighborhood for bonuses

## 4. RETENTION HOOKS

### *Notification System*
- Notifications for:
  - Operation completion
  - Territory under threat
  - Special opportunities
  - Heat level warnings
  - and more..
- Customizable notification preferences
- Log or history of all actions undertaken

### *Comeback Mechanics*
- Increased success chance for operations after consecutive failures
- Protection period after major losses
- "Underdog" bonuses when targeting more successful players

## 5. TECHNICAL IMPLEMENTATION FOCUS

### *Server Architecture*
- Golang, gorm, postgresql with chi router
- Simple state-based system with timestamp tracking
- Calculation of outcomes at time of player interaction
- Asynchronous action resolution
- Minimal real-time requirements
- Response and request should be wrapped in an object and payloads, errors, warnings, system messages will be transmitted through that object for uniformity.
- There should also be a game message to allow for the transmission of gameplay related messages such as restrictions and action successes/action failures. 

### *Database Structure*
- Player profiles with core stats
- Legal business hotspots ownership registry, seperate from the regions, district, cities and hotspots registry
- Heat, influence, respect and resources accounting
- Completed actions log

### *Constants*
- Game mechanics algorithms and calculations should be in a yaml file as to allow easier game balancing later.
- Mechanics and calculations in the backend services should be read from that instead of hardcoded.
- Territorial data should also be in a seperate yaml file in a hierarchial structure which can then be seeded into the database.
- While legal businesses are fixed hotspots, illegal businesses are hotspots that tend to be refreshed, should be randomized and come from a pool of preset data.

### *Client Requirements*
- Vue3 script setup typescript with responsive design.
- Pinia for state management, vue router and axios
- Main menu should be in the header nav and structures as follows:
  - **Home**: Main overview shows a summarized view of all the game components/systems.
  - **Territory**: Territory map is where all the territorial actions can take place. A floating panel right below the header navbar with dropdowns for regions, districts and cities and a dropdown to show legal/illegal business/all as a filtering mechanism.
  - **Operations**: Shows all the operations available and filterable as well similar to territory.
  - **Market**: Market is an interface to buy and sell resources with inflation/deflation indicators.
  - **Rankings**: Leaderboards and various ranking of players as well as measurement metrics relative to the player and globally. 
  - **NFT**: Allows player to convert certain elements in the game into NFTs (only a mock up for now, no implementation needed)
- Sidebar on the left should contain all the player main stats, resources, attributes, etc.
- Footer containing the standard detail or information.
- UI design show have a centralized styling and use that as much as possible rather than having duplicate styling in each of the component codes.
- UI/UX layout should have a polished bespoke design of a simulation game that looks cool, and immersive and portrays the thematic elements of a game of this type and should not look like a business or regular application.

## 6. MEASUREMENT METRICS

### *Key Performance Indicators*
- Daily active users
- Average session frequency
- Operation completion rate
- Territory control distribution
- Economy balance (inflation/deflation)
- Retention at 1/7/30 days

### *Player Behavior Tracking*
- Most popular operation types
- Territory control patterns
- Resource sink effectiveness
- Social interaction frequency
- Session length and timing

